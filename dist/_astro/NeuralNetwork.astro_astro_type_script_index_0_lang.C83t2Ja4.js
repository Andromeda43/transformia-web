document.addEventListener("DOMContentLoaded",()=>{const x=document.querySelector(".neural-network-visualization"),S=document.querySelector(".connections-container"),s=document.querySelectorAll(".layer");document.querySelectorAll(".node");function N(){if(!x||!S)return;const t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.setAttribute("width","100%"),n.setAttribute("height","100%");const i=document.createElementNS(t,"defs"),e=document.createElementNS(t,"linearGradient");e.setAttribute("id","connection-gradient-input"),e.setAttribute("x1","0%"),e.setAttribute("y1","0%"),e.setAttribute("x2","100%"),e.setAttribute("y2","0%");const r=document.createElementNS(t,"stop");r.setAttribute("offset","0%"),r.setAttribute("stop-color","rgba(100, 200, 255, 0.6)");const a=document.createElementNS(t,"stop");a.setAttribute("offset","100%"),a.setAttribute("stop-color","rgba(176, 66, 255, 0.6)"),e.appendChild(r),e.appendChild(a);const o=document.createElementNS(t,"linearGradient");o.setAttribute("id","connection-gradient-hidden"),o.setAttribute("x1","0%"),o.setAttribute("y1","0%"),o.setAttribute("x2","100%"),o.setAttribute("y2","0%");const u=document.createElementNS(t,"stop");u.setAttribute("offset","0%"),u.setAttribute("stop-color","rgba(176, 66, 255, 0.6)");const l=document.createElementNS(t,"stop");l.setAttribute("offset","100%"),l.setAttribute("stop-color","rgba(176, 66, 255, 0.6)"),o.appendChild(u),o.appendChild(l);const c=document.createElementNS(t,"linearGradient");c.setAttribute("id","connection-gradient-output"),c.setAttribute("x1","0%"),c.setAttribute("y1","0%"),c.setAttribute("x2","100%"),c.setAttribute("y2","0%");const M=document.createElementNS(t,"stop");M.setAttribute("offset","0%"),M.setAttribute("stop-color","rgba(176, 66, 255, 0.6)");const C=document.createElementNS(t,"stop");C.setAttribute("offset","100%"),C.setAttribute("stop-color","rgba(255, 100, 200, 0.6)"),c.appendChild(M),c.appendChild(C),i.appendChild(e),i.appendChild(o),i.appendChild(c),n.appendChild(i);for(let m=0;m<s.length-1;m++){const k=s[m],H=s[m+1],B=k.querySelectorAll(".node"),L=H.querySelectorAll(".node");let f;m===0?f="connection-gradient-input":m===s.length-2?f="connection-gradient-output":f="connection-gradient-hidden",B.forEach(G=>{const A=G.getBoundingClientRect(),b=x.getBoundingClientRect(),T=A.left-b.left+A.width/2,I=A.top-b.top+A.height/2,g=window.innerWidth<=576,D=g?2:4,F=Math.min(L.length,D);[...L].sort(()=>.5-Math.random()).slice(0,F).forEach(P=>{const y=P.getBoundingClientRect(),$=y.left-b.left+y.width/2,q=y.top-b.top+y.height/2,d=document.createElementNS(t,"line");if(d.setAttribute("x1",T.toString()),d.setAttribute("y1",I.toString()),d.setAttribute("x2",$.toString()),d.setAttribute("y2",q.toString()),d.setAttribute("stroke",`url(#${f})`),d.setAttribute("stroke-width",g?"0.8":"1"),d.setAttribute("stroke-opacity",(Math.random()*.3+.2).toString()),n.appendChild(d),Math.random()>(g?.85:.7)){const p=document.createElementNS(t,"circle");p.setAttribute("r",g?"2":"3"),p.setAttribute("fill","#ffffff"),p.setAttribute("opacity","0.7");const h=document.createElementNS(t,"animateMotion");h.setAttribute("path",`M${T},${I} L${$},${q}`),h.setAttribute("dur",Math.random()*2+1+"s"),h.setAttribute("repeatCount","indefinite"),h.setAttribute("begin",Math.random()*3+"s"),p.appendChild(h),n.appendChild(p)}})})}S.innerHTML="",S.appendChild(n)}function R(){const t=Math.floor(Math.random()*(s.length-1)),i=s[t].querySelectorAll(".node"),e=Math.floor(Math.random()*i.length),r=i[e];E(r),setTimeout(()=>{v(t+1,e)},100)}function E(t){t.classList.add("active"),setTimeout(()=>{t.classList.remove("active")},500)}function v(t,n){if(t>=s.length)return;const e=s[t].querySelectorAll(".node"),r=Math.floor(Math.random()*3)+1;for(let a=0;a<r;a++){let o;if(Math.random()>.7){const l=Math.floor(Math.random()*3)-1;o=Math.max(0,Math.min(e.length-1,n+l))}else o=Math.floor(Math.random()*e.length);const u=e[o];setTimeout(()=>{E(u),t<s.length-1&&setTimeout(()=>{v(t+1,o)},100)},50*a)}}function z(){const t=document.querySelector(".status-value.accuracy"),n=document.querySelector(".status-value.epoch");if(t&&n){setInterval(()=>{const o=t.textContent||"96.8%",u=parseFloat(o),l=(Math.random()-.5)*.4,c=Math.max(95.5,Math.min(98.5,u+l));t.textContent=c.toFixed(1)+"%"},5e3);const i=n.textContent||"83/100";let e=parseInt(i.split("/")[0]);const r=parseInt(i.split("/")[1]||"100"),a=setInterval(()=>{e++,n&&(n.textContent=`${e}/${r}`),e>=r&&(clearInterval(a),setTimeout(()=>{e=0,n&&(n.textContent=`${e}/${r}`),setInterval(()=>{e=Math.min(r,e+1),n&&(n.textContent=`${e}/${r}`)},8e3)},1e4))},8e3)}}function O(){clearTimeout(window.resizeTimeout),window.resizeTimeout=setTimeout(()=>{N()},250)}function w(){N(),setInterval(R,2e3),z(),window.addEventListener("resize",O)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{setTimeout(w,1e3)}):setTimeout(w,1e3)});
