document.addEventListener("DOMContentLoaded",()=>{const E=document.querySelector(".neural-network-visualization"),I=document.querySelector(".connections-container"),i=document.querySelectorAll(".layer");document.querySelectorAll(".node");function L(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width","100%"),t.setAttribute("height","100%");const o=document.createElementNS("http://www.w3.org/2000/svg","defs"),e=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");e.setAttribute("id","connection-gradient-input"),e.setAttribute("x1","0%"),e.setAttribute("y1","0%"),e.setAttribute("x2","100%"),e.setAttribute("y2","0%");const n=document.createElementNS("http://www.w3.org/2000/svg","stop");n.setAttribute("offset","0%"),n.setAttribute("stop-color","rgba(100, 200, 255, 0.6)");const a=document.createElementNS("http://www.w3.org/2000/svg","stop");a.setAttribute("offset","100%"),a.setAttribute("stop-color","rgba(176, 66, 255, 0.6)"),e.appendChild(n),e.appendChild(a);const r=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");r.setAttribute("id","connection-gradient-hidden"),r.setAttribute("x1","0%"),r.setAttribute("y1","0%"),r.setAttribute("x2","100%"),r.setAttribute("y2","0%");const s=document.createElementNS("http://www.w3.org/2000/svg","stop");s.setAttribute("offset","0%"),s.setAttribute("stop-color","rgba(176, 66, 255, 0.6)");const u=document.createElementNS("http://www.w3.org/2000/svg","stop");u.setAttribute("offset","100%"),u.setAttribute("stop-color","rgba(176, 66, 255, 0.6)"),r.appendChild(s),r.appendChild(u);const c=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");c.setAttribute("id","connection-gradient-output"),c.setAttribute("x1","0%"),c.setAttribute("y1","0%"),c.setAttribute("x2","100%"),c.setAttribute("y2","0%");const b=document.createElementNS("http://www.w3.org/2000/svg","stop");b.setAttribute("offset","0%"),b.setAttribute("stop-color","rgba(176, 66, 255, 0.6)");const f=document.createElementNS("http://www.w3.org/2000/svg","stop");f.setAttribute("offset","100%"),f.setAttribute("stop-color","rgba(255, 100, 200, 0.6)"),c.appendChild(b),c.appendChild(f),o.appendChild(e),o.appendChild(r),o.appendChild(c),t.appendChild(o);for(let l=0;l<i.length-1;l++){const R=i[l],T=i[l+1],k=R.querySelectorAll(".node"),C=T.querySelectorAll(".node");let m;l===0?m="connection-gradient-input":l===i.length-2?m="connection-gradient-output":m="connection-gradient-hidden",k.forEach(O=>{const g=O.getBoundingClientRect(),w=E.getBoundingClientRect(),M=g.left-w.left+g.width/2,S=g.top-w.top+g.height/2,B=Math.min(C.length,4);[...C].sort(()=>.5-Math.random()).slice(0,B).forEach(G=>{const A=G.getBoundingClientRect(),x=A.left-w.left+A.width/2,N=A.top-w.top+A.height/2,d=document.createElementNS("http://www.w3.org/2000/svg","line");if(d.setAttribute("x1",M),d.setAttribute("y1",S),d.setAttribute("x2",x),d.setAttribute("y2",N),d.setAttribute("stroke",`url(#${m})`),d.setAttribute("stroke-width","1"),d.setAttribute("stroke-opacity",(Math.random()*.3+.2).toString()),t.appendChild(d),Math.random()>.7){const p=document.createElementNS("http://www.w3.org/2000/svg","circle");p.setAttribute("r","3"),p.setAttribute("fill","#ffffff"),p.setAttribute("opacity","0.7");const h=document.createElementNS("http://www.w3.org/2000/svg","animateMotion");h.setAttribute("path",`M${M},${S} L${x},${N}`),h.setAttribute("dur",Math.random()*2+1+"s"),h.setAttribute("repeatCount","indefinite"),h.setAttribute("begin",Math.random()*3+"s"),p.appendChild(h),t.appendChild(p)}})})}I.appendChild(t)}function $(){const t=Math.floor(Math.random()*(i.length-1)),e=i[t].querySelectorAll(".node"),n=Math.floor(Math.random()*e.length),a=e[n];y(a),setTimeout(()=>{v(t+1,n)},100)}function y(t){t.classList.add("active"),setTimeout(()=>{t.classList.remove("active")},500)}function v(t,o){if(t>=i.length)return;const n=i[t].querySelectorAll(".node"),a=Math.floor(Math.random()*3)+1;for(let r=0;r<a;r++){let s;if(Math.random()>.7){const c=Math.floor(Math.random()*3)-1;s=Math.max(0,Math.min(n.length-1,o+c))}else s=Math.floor(Math.random()*n.length);const u=n[s];setTimeout(()=>{y(u),t<i.length-1&&setTimeout(()=>{v(t+1,s)},100)},50*r)}}function q(){const t=document.querySelector(".status-value.accuracy"),o=document.querySelector(".status-value.epoch");if(t&&o){setInterval(()=>{const r=parseFloat(t.textContent),s=(Math.random()-.5)*.4,u=Math.max(92,Math.min(99.5,r+s));t.textContent=u.toFixed(1)+"%"},5e3);let e=parseInt(o.textContent.split("/")[0]);const n=parseInt(o.textContent.split("/")[1]),a=setInterval(()=>{e++,o.textContent=`${e}/${n}`,e>=n&&(clearInterval(a),setTimeout(()=>{e=0,o.textContent=`${e}/${n}`,setInterval(()=>{e=Math.min(n,e+1),o.textContent=`${e}/${n}`},8e3)},1e4))},8e3)}}setTimeout(()=>{L(),setInterval($,2e3),q()},1e3)});
